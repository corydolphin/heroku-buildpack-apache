#!/usr/bin/env bash
# bin/release <build-dir>


# Fail fast and fail hard.
set -eo pipefail

function set-env (){
  echo "export $1=$2" >> $PROFILE_PATH
}

# Usage: $ set-default-env key value
function set-default-env (){
  echo "export $1=\${$1:-$2}" >> $PROFILE_PATH
}

indent() {
  sed -u 's/^/       /'
}

echo "-----> Vendoring Apache Httpd"


mkdir -p $1/vendor

curl https://raw.github.com/wcdolphin/vulcan-apache/master/apache-bench.tgz --silent -o - | tar -xz -C $1/vendor -f -

set-env LD_LIBRARY_PATH '/app/vendor/apache-2.4.4/lib/:$LD_LIBRARY_PATH'
set-default-env LD_LIBRARY_PATH '/app/vendor/apache-2.4.4/lib/:$LD_LIBRARY_PATH'
